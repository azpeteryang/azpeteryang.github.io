---
title: 'Simple recommendation system in python'
date: 2020-05-17
permalink: /posts/2020/03/blog-post-2/
tags:
  - Recommendation System
---

```python
import numpy as np
from lightfm.datasets import fetch_movielens
from lightfm import LightFM


#fetch data and format it
data = fetch_movielens(min_rating = 4.0)

#print training and testing data
print(repr(data['train']))
print(repr(fata['test']))

# create model
model = LightFM(loss='warp')
# train model
model.fit(data['train'],epochs = 30, num_threads = 2)

def sample_recommendation(model,data,user_ids):

  #number of users and movies in training data
  n_users, n_items = data['train'].shape
  
  #generate recommendations for each user we imput
  for user_id in user_ids:
  
    #movies they already like
    known _positives = data['item_labels'][data['train'].tocsr()[user_id].indicies]
```
